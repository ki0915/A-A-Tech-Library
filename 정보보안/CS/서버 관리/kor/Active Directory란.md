
# Active Directory란?
]

![](https://velog.velcdn.com/images/tkops365/post/cf0ba30b-ac69-496e-9b51-a58076dd2d7e/image.jpg)


Active Directory란 컴퓨터 네트워크의 공통 구성 요소 관리를 AD(Active Directory) 라는 단일 저장소에 중앙 집중화하는 것입니다. 좀 더 쉽게 설명하자면 회사 직원들의 계정 정보(ID, Password)와 컴퓨터에 대한 정보, 그리고 강제하고자 하는 정책들(ex 비밀번호는 9자리 이상) 에 대한 정보를 저장하는 데이터 베이스 같은 거라고 생각하면 됩니다. 저는 회사 서버를 관리하는 입장이라 익숙하지만, 처음 들을 때는 다소 난해할 수 있습니다.  이 Active Directory를 실행하는 서버를 DC(도메인 컨트롤러)라고 합니다. 

> 장점

중앙 집중식 ID 관리: 네트워크의 모든 사용자를 쉽게 컨트롤하고 제어할 수 있습니다. 
보안 정책 관리: Active Directory에서 직접 보안 정책을 구성하고 필요에 따라 네트워크를 통해 사용자와 컴퓨터에 적용할 수 있습니다.

마음대로 네트워크와 네트워크 내에 단말기에 정책을 강요할 수 있는 등에 편의성이 있습니다. 컴퓨터 하나하나마다 설정을 바꿔주는 건 매우 번거로우니 이런 방법은 매우 편리하죠.

> 구성


모든 Windows 도메인의 책심은 AD DS(Active Directory 도메인 서비스)입니다. 이 서비스는 네트워크에 존재하는 모든 "객체"의 정보를 보유하는 카탈로그 역할을 합니다. 객체에는 사용자, 그룹, 프린터, 공유 등등이 있습니다.



### 사용자

사용자는 두 가지 유형의 객체로 나타낼 수 있습니다.

1. 사람: 사용자는 일반적으로 직원처럼 네트워크에 접근하는 조직 안 의 사람을 의미합니다.(회사 직원)

![](https://velog.velcdn.com/images/tkops365/post/2240c28c-4725-46d9-8986-841d0e3ff4e0/image.png)


2. 서비스: IIS 또는 MSSQL과 같은 서비스에 사용할 서비스를 정의할 수 있습니다. 이 경우으 ㅣ사용자는 특정 서비스를 실행하는 데 필요한 권한만 갖습니다.

![](https://velog.velcdn.com/images/tkops365/post/f500239b-d2d2-4785-91d3-b1bd96611d4e/image.png)

![](https://velog.velcdn.com/images/tkops365/post/8a395244-72fd-4e25-8412-99aee61a8b83/image.png)



### 기계

기계는 AD 도메인에 가입하는 모든 컴퓨터에 대한 것입니다. 기계는 보안 주체로 간주되며 일반 사용자와 마찬가지로 계정이 할당됩니다. 이 계정은 도메인 내에서 제한된 권한을 갖습니다.

컴퓨터 계정 자체는 할당된 컴퓨터의 로컬 관리자이며 일반적으로 컴퓨터 자체를 제외한 다른 사람이 접근할 수 있지만, 비밀번호가 있으면 로그인 가능합니다. 

주의!: 컴퓨터 계정 비밀번호는 자동으로 교체되며 일반적으로는 120개의 임의의 문자로 구성됩니다.

![](https://velog.velcdn.com/images/tkops365/post/09210179-107a-46f6-b6ef-0ba922829fc4/image.png)


### 보안 그룹


말 그대로 사용자 그룹입니다. 그룹에 사용자를 추가하여 손쉽게 관리할 수 있습니다. 해당 사용자는 그룹에 부벼되어 있는 모든 권한을 자동으로 상속받게 됩니다. 보안 그룹은 보안 주체로도 간주되므로 네트워크 리소스에 대한 권한을 
자길 수 있습니다.

주의!) 그룹은 사용자와 컴퓨터를 모두 구성원으로 가질 수 있습니다. 필요한 경우에 다른 그룹도 포함될 수 있습니다.


아래는 그룹의 예입니다.

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>도메인 그룹 설명</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
        }
        h3 {
            color: #2c3e50;
        }
        p {
            margin: 10px 0;
        }
        .group-name {
            font-weight: bold;
            color: #2980b9;
        }
    </style>
</head>
<body>
    <h3>보안 그룹 설명</h3>
    
    <p><span class="group-name">도메인 관리자:</span> 이 그룹의 사용자는 전체 도메인에 대한 관리 권한을 갖습니다. 기본적으로 이들은 DC를 포함하여 도메인의 모든 컴퓨터를 관리할 수 있습니다.</p>
    
    <p><span class="group-name">서버 운영자:</span> 이 그룹의 사용자는 도메인 컨트롤러를 관리할 수 있습니다. 관리 그룹 구성원 자격은 변경할 수 없습니다.</p>
    
    <p><span class="group-name">백업 운영자:</span> 이 그룹의 사용자는 권한을 무시하고 모든 파일에 액세스할 수 있습니다. 컴퓨터에서 데이터 백업을 수행하는 데 사용됩니다.</p>
    
    <p><span class="group-name">계정 운영자:</span> 이 그룹의 사용자는 도메인의 다른 계정을 만들거나 수정할 수 있습니다.</p>
    
    <p><span class="group-name">도메인 사용자:</span> 도메인의 모든 기존 사용자 계정을 포함합니다.</p>
    
    <p><span class="group-name">도메인 컴퓨터:</span> 도메인에 있는 모든 기존 컴퓨터를 포함합니다.</p>
    
    <p><span class="group-name">도메인 컨트롤러:</span> 도메인의 모든 기존 DC를 포함합니다.</p>
    
</body>
</html>



#### 조직 단위(OU)


사용자와 시스템을 분류할 수 있는 컨테이너 개체입니다. 주로 유사한 정책 요구 사항을 가진 사용자 집합을 정의하는 데 사용됩니다. 예를 들자면 영업 부서의 직원은 개발 부서의 직원과 다른 정책 집합을 적용할 가능성이 높습니다. 그리고 사용자는 한번에 하나의 OU에만 속할 수 있다는 점을 기억하세요.


<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>자동 생성 조직 단위</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
        }
        h3 {
            color: #2c3e50;
        }
        p {
            margin: 10px 0;
        }
        .ou-name {
            font-weight: bold;
            color: #2980b9;
        }
    </style>
</head>
<body>
    <h3>자동 생성 조직 단위</h3>
    
    <p><span class="ou-name">내장:</span> 모든 Windows 호스트에서 사용할 수 있는 기본 그룹이 포함되어 있습니다.</p>
    
    <p><span class="ou-name">컴퓨터:</span> 네트워크에 연결된 모든 컴퓨터는 기본적으로 여기에 배치됩니다. 필요한 경우 이동할 수 있습니다.</p>
    
    <p><span class="ou-name">도메인 컨트롤러:</span> 네트워크의 DC를 포함하는 기본 OU입니다.</p>
    
    <p><span class="ou-name">사용자:</span> 도메인 전체 컨텍스트에 적용되는 기본 사용자 및 그룹입니다.</p>
    
    <p><span class="ou-name">관리 서비스 계정:</span> Windows 도메인의 서비스에서 사용되는 계정을 보유합니다.</p>
    
</body>
</html>




**추가) 그룹 정책 개체(GPO)를 통해 각 OU에 대해 개별적으로 서로 다른 정책을 배포할 수 있습니다.  GPO에는 사용자 또는 컴퓨터를 대상으로 하는 정책이 포함될 수 있으므로 특정 컴퓨터 및 ID에 대한 기준을 설정할 수 있습니다.**

* 보안 그룹과 조직 단위의 차이

조직 단위: <span style="color: red">정책을 적용하는데 주로 사용</span>
보안 그룹: <span style="color: red">리소스에 대한 권한을 부여하는 데 사용</span>


## AD 관리


이부분은 사용자도 기계도 비슷합니다. 용도에 따라 장치와 사용자를 분리하는 것입니다. 인트라넷용 컴퓨터, 개발팀 개인 컴퓨터 등등은 서로 분리하는 것이 좋은 것 처럼 말입니다.


## AD 인증 방법


Windows Domian을 사용하는 경우 모든 자격 증명은 도메인 컨트롤러에 저장이 됩니다. 사용자는 이 자격 증명을 사용하여 서비스에 인증을 시도하고 서비스는 도메인 컨트롤러에 인증이 올바른지 요청하죠. 
인증에는 두 가지 프로토콜을 사용할 수 있습니다. 저도 해킹 공부 하면서 간간히 접한 프로토콜들입니다.


<p><span class="ou-name">Kerberos : 최신 버전의 Windows에서 사용됩니다. 이는 최근 도메인의 기본 프로토콜입니다.</span></p>
<p><span class="ou-name">NetNTLM: 호환성을 위해 유지되는 레거시 인증 프로토콜입니다.
</span></p>
NetNTLM은 더 이상 사용하지 않는 경우가 많다고 들었지만, 대두분의 네트워크에는 두 프로토콜이 살아있습니다. 


## 확장 


기업이 성장하면 네트워크도 커집니다. 당연한 결과죠. 서비스가 많아지고 관리할 정보들이 늘어나면 네트워크의 크기도 커지니까요.  이때 커지는 방식을 저희는 알고 있습니다. 알고리즘이든, 플로우 차트든, 반드시 보게 되는 구조니까요.

맞습니다. 트리 구조입니다. 

![](https://velog.velcdn.com/images/tkops365/post/26ad27f9-1911-450e-be22-017ff2279379/image.png)


Active Diretory는 여러 도메인 통합을 지원하므로 네트워크를 독립적으로 관리할 수 있는 단위로 분할할 수 있습니다. 동일한 네임스페이스를 공유하게 만들어서 해당 도메인들을 tree 형태로 결합할 수 있습니다.

도메인이 영국 및 미국 지점에 대해 두 개의 하위 도메인으로 분할된 경우 루트 도메인 과 및라는 두 개의 하위 도메인 thm.local이 있는 트리를 구축할 수 있으며 각각에는 해당 AD , 컴퓨터 및 사용자가 있습니다..

이 분할된 구조를 통해 도메인에서 누가 무엇에 액세스할 수 있는지 더 효과적으로 제어할 수 있습니다. 영국의 IT 인력은 영국 리소스만 관리하는 자체 DC를 갖게 됩니다. 예를 들어 영국 사용자는 미국 사용자를 관리할 수 없습니다. 이러한 방식으로 각 지점의 도메인 관리자는 해당 DC를 완전히 제어할 수 있지만 다른 지점의 DC는 제어할 수 없습니다. 트리의 각 도메인에 대해 정책을 독립적으로 구성할 수도 있습니다.


하지만 다른 네임 스페이스를 가진 회사들끼리 합병되는 경우도 잦습니다. 이럴 때는 어떻게 해야할까요? 맞습니다. 나무 목이라는 한자 두개가 모여 수풀 림이라는 한자가 되듯이, 도메인도 숲이 되면됩니다. 서로 다른 네임스페이스를 가진 여러 트리를 동일한 네트워크로 통합하는 것을 포레스트라고 합니다 .

여러 도메인을 트리와 포레스트로 구성하면 관리 및 리소스 측면에서 훌륭하게 구획화된 네트워크를 가질 수 있습니다. 그러나 특정 시점에 THM UK 의 사용자는 MHT ASIA 서버 중 하나에 있는 공유 파일에 액세스해야 할 수도 있습니다. 이를 위해서는 트리와 포레스트에 배열된 도메인이 신뢰 관계 로 결합됩니다 .

간단히 말해서, 도메인 간에 신뢰 관계가 있으면 다른 도메인의 사용자에게 다른 도메인의 리소스에 액세스할 수 있는  권한을 부여할 수 있습니다. 이 관계는 단방향으로도, 양방향으로도 구성할 수 있습니다. 




이렇게 Active Directory에 알아봤습니다. 평소에 서버를 관라할 때에는 개념만 알고 넘어갔는데 다시 제대로 지식을 되새김해보니 더 넓게 시야가 트이네요. 앞으로 좀 더 많이 보안, 네트워크 지식을 알아가야 겠습니다.